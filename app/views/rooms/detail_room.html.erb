<%= form_with url: search_rooms_path, method: :get, local: true do %>
  <div class="search_facility_afterview">

    <div class="search_box_common">
      <%= text_field_tag :area, params[:area], placeholder: "エリア名を入力" ,class:'search_box_area' %>
    </div>
    
    <div class="search_box_common">
      <%= text_field_tag :query, params[:query], placeholder: "キーワードを入力" ,class:'search_box_area' %>
    </div>
    
    <div class="search_button_common">
      <%= submit_tag "検索", class: "search-button" %>
    </div>
  </div>
<% end %>

  <div class="view_back_button">
    <%= link_to "← 検索結果に戻る", search_rooms_path(area: params[:area], query: params[:query]), class: "view_back" %>
  </div>

<div class="reservation_room_container">

  <div class="detail_roomimg">
    <%= image_tag(@room.roomimage.attached? ? @room.roomimage.variant(resize_to_limit: [347, 200]) : "default-myroom.png", alt: "施設写真") %>
  </div>

  <div class ="view_reservation">

    <div class="detailinfo_container">
      <div class="detailinfo_roomname">
        <%= @room.room_name %>
      </div>
      <div class="details_roomrate">
        <span class="room" data-room-rate="<%= @room.room_rate.to_f %>"></span>
        <span class="convert_rate"><%= @room.room_rate %></span>
      </div>
    </div>
  
    <div class="detailinput_wrap">
      <div class="detailimfo_address">
        <%= @room.facility_address %>
      </div>

      <div class="detailimfo_roomdetails">
        <%= @room.room_details %>
      </div>
    </div>

    <div class="reservation_wrap">
      <%= form_with model: @reservation, url: confirm_room_reservations_path(@room), method: :post, local: true do |f| %>

      <div class="reservationform_area">
        <div class="checkin">
          <%= f.label :checkin_day ,"チェックイン" %>
          <%= f.date_field :checkin_day ,id: "checkin_day"%>
        </div>

        <div class="checkout">
          <%= f.label :checkout_day ,"チェックアウト" %>
          <%= f.date_field :checkout_day ,id: "checkout_day"%>
        </div>

        <div class="number_of_guests">
          <%= f.label :number_of_guests ,"人数" %>
          <%= f.number_field :number_of_guests, placeholder:"0人" ,id: "guest_count"%>
        </div>
      </div>

      <% if @reservation.errors.any? %>
        <div class="error_messages">
          <div class="error"><%= @reservation.errors[:checkin_day].first %></div>
          <div class="error"><%= @reservation.errors[:checkout_day].first %></div>
          <div class="error"><%= @reservation.errors[:number_of_guests].first %></div>
        </div>
      <% end %>

        <div class="input_reservation_wrap">
          <% if current_user %>
            <%= f.submit "予約に進む", class:"input_reservation" %>
          <% else %>
            <%= link_to "ログイン", login_path, class:"linkto_login" %>
          <% end%>
        </div>

      <% end %>
  </div>   
</div>